---
title: "Prediction"
output: html_document
---

In this Markdown file, I will illustrate how I predict the category of a set of NEW rows using a clustering method. 

```{r setup,message=FALSE,warning=FALSE}
library(tidyverse)
### I will use "caret" package for model building
library(caret)
```

First, I will randomly pick 5 rows in the dataset and make them into a testing set and the rest of them are in the training set. I will include the categoriacal varaible `Label` in the training set and remove it from testing set.

```{r message=FALSE,warning=FALSE}
Foodborne<-read.csv("/Users/nikkkikong/Desktop/ANLY 501/project data/Foodborne_forcluster.csv",header = TRUE)
Foodborne$Label<-as.factor(Foodborne$Label)
set.seed(2)
picked = sample(seq_len(nrow(Foodborne)),size = 5)
Foodborne.test =Foodborne[picked,]
Foodborne.train =Foodborne[-picked,]
Foodborne.test<-Foodborne.test[,1:3]
```

I will use Nearest Neighbors Algorithms and perform 5-folds Cross validation study repeated 5 times to build the model and predict the category in testing dataset. Here I normalize the variables, and choose number of k from 1 to 6.

```{r message=FALSE,warning=FALSE}
set.seed(2)
our.training <- trainControl(method="repeatedcv", number=5, repeats=5)
mod.knn <-  train(Label~ Illnesses+Hospitalizations+Deaths,
                         data = Foodborne.train,
                         method="knn",
                         preProcess=c("center", "scale"),
                         tuneGrid=expand.grid(k=seq(1,6,1)) )
# check the exact k choose from the model 
mod.knn$bestTune
my.prediction<-data.frame(Label=predict(mod.knn,newdata = Foodborne.test))
my.prediction<-cbind(Foodborne.test,my.prediction)
my.prediction
```

The above table shows the testing dataset and the result of the prediction in `Label`, the model suggeats k=6.




